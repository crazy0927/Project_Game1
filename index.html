<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¶“å…¸å°ç‘ªè‰ - å¾©å¤éº»ä»”å°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');

        body {
            background-color: #1a1a1a;
            font-family: 'Orbitron', sans-serif;
            user-select: none;
            touch-action: manipulation;
        }

        .game-container {
            max-width: 600px;
            margin: 20px auto;
            background: #2d2d2d;
            border: 8px solid #444;
            border-radius: 15px;
            box-shadow: 0 0 50px rgba(0,0,0,0.5), inset 0 0 20px rgba(0,0,0,0.8);
            padding: 15px;
        }

        /* è·‘ç‡ˆæ ¼å­ */
        .slot-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 4px;
            margin-bottom: 20px;
        }

        .slot-item {
            aspect-ratio: 1;
            background: #333;
            border: 2px solid #555;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: #ccc;
            position: relative;
            transition: all 0.1s;
        }

        .slot-item.active {
            background: #ffff00;
            border-color: #ff0000;
            box-shadow: 0 0 15px #ffff00;
            transform: scale(1.05);
            z-index: 10;
        }

        .slot-item.active .symbol {
            transform: scale(1.2);
            color: #000;
        }

        .symbol {
            font-size: 1.5rem;
            margin-bottom: 2px;
        }

        .multiplier {
            font-size: 0.6rem;
            color: #ffcc00;
        }

        /* ä¸­é–“æ§åˆ¶å€åŸŸ */
        .center-panel {
            grid-column: 2 / 7;
            grid-row: 2 / 5;
            background: #111;
            border: 2px inset #444;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            color: #0f0;
            text-shadow: 0 0 5px #0f0;
        }

        .display-screen {
            font-size: 2rem;
            margin-bottom: 10px;
            background: #000;
            padding: 5px 20px;
            border-radius: 5px;
            border: 1px solid #333;
            min-width: 150px;
            text-align: center;
        }

        /* æŠ¼æ³¨å€ */
        .bet-area {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .bet-button {
            background: linear-gradient(145deg, #444, #222);
            border: 2px solid #666;
            border-radius: 8px;
            padding: 8px;
            text-align: center;
            cursor: pointer;
            transition: active 0.1s;
        }

        .bet-button:active {
            transform: translateY(2px);
            background: #555;
        }

        .bet-button.has-bet {
            border-color: #ff00ff;
            box-shadow: 0 0 5px #ff00ff;
        }

        .bet-count {
            color: #ff00ff;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* æŒ‰éˆ•ç‰¹æ•ˆ */
        .btn-primary {
            background: linear-gradient(to bottom, #ff4d4d, #990000);
            box-shadow: 0 4px 0 #660000;
            transition: all 0.1s;
        }

        .btn-primary:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #660000;
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: 0 4px 0 #660000 !important;
        }

        .neon-text {
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .win-blink {
            animation: blink 0.2s infinite;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <div class="game-container w-full">
        <!-- é ‚éƒ¨è³‡è¨Šåˆ— -->
        <div class="flex justify-between items-center mb-4 px-2 text-white">
            <div class="bg-black p-2 rounded border border-gray-700">
                <span class="text-xs text-gray-400 block">ç¸½åˆ† CREDITS</span>
                <span id="total-credits" class="text-xl text-yellow-400">1000</span>
            </div>
            <h1 class="text-2xl font-bold text-red-500 italic neon-text">å°ç‘ªè‰</h1>
            <div class="bg-black p-2 rounded border border-gray-700">
                <span class="text-xs text-gray-400 block">æœ¬æ¬¡å¾—åˆ† WIN</span>
                <span id="win-display" class="text-xl text-green-400">0</span>
            </div>
        </div>

        <!-- è·‘ç‡ˆæ ¼å­—å€åŸŸ -->
        <div id="slot-grid" class="slot-grid">
            <!-- ç”± JS ç”Ÿæˆ -->
        </div>

        <!-- æŠ¼æ³¨æ§åˆ¶å€ -->
        <div class="bet-area mb-6">
            <div onclick="placeBet('BAR')" class="bet-button">
                <div class="text-xs text-gray-400">BAR</div>
                <div class="text-lg">ğŸ†</div>
                <div id="bet-BAR" class="bet-count">0</div>
                <div class="text-[10px] text-yellow-500">x100</div>
            </div>
            <div onclick="placeBet('77')" class="bet-button">
                <div class="text-xs text-gray-400">77</div>
                <div class="text-lg">ğŸ’</div>
                <div id="bet-77" class="bet-count">0</div>
                <div class="text-[10px] text-yellow-500">x40</div>
            </div>
            <div onclick="placeBet('STAR')" class="bet-button">
                <div class="text-xs text-gray-400">æ˜Ÿæ˜Ÿ</div>
                <div class="text-lg">â­</div>
                <div id="bet-STAR" class="bet-count">0</div>
                <div class="text-[10px] text-yellow-500">x30</div>
            </div>
            <div onclick="placeBet('MELON')" class="bet-button">
                <div class="text-xs text-gray-400">è¥¿ç“œ</div>
                <div class="text-lg">ğŸ‰</div>
                <div id="bet-MELON" class="bet-count">0</div>
                <div class="text-[10px] text-yellow-500">x20</div>
            </div>
            <div onclick="placeBet('BELL')" class="bet-button">
                <div class="text-xs text-gray-400">éˆ´éº</div>
                <div class="text-lg">ğŸ””</div>
                <div id="bet-BELL" class="bet-count">0</div>
                <div class="text-[10px] text-yellow-500">x20</div>
            </div>
            <div onclick="placeBet('LEMON')" class="bet-button">
                <div class="text-xs text-gray-400">æª¸æª¬</div>
                <div class="text-lg">ğŸ‹</div>
                <div id="bet-LEMON" class="bet-count">0</div>
                <div class="text-[10px] text-yellow-500">x15</div>
            </div>
            <div onclick="placeBet('ORANGE')" class="bet-button">
                <div class="text-xs text-gray-400">æ©˜å­</div>
                <div class="text-lg">ğŸŠ</div>
                <div id="bet-ORANGE" class="bet-count">0</div>
                <div class="text-[10px] text-yellow-500">x10</div>
            </div>
            <div onclick="placeBet('CHERRY')" class="bet-button">
                <div class="text-xs text-gray-400">æ«»æ¡ƒ</div>
                <div class="text-lg">ğŸ’</div>
                <div id="bet-CHERRY" class="bet-count">0</div>
                <div class="text-[10px] text-yellow-500">x5</div>
            </div>
        </div>

        <!-- ä¸»è¦æŒ‰éˆ• -->
        <div class="flex gap-4">
            <button id="clear-btn" onclick="clearBets()" class="flex-1 py-4 bg-gray-600 rounded-lg text-white font-bold border-b-4 border-gray-800 active:transform active:translate-y-1 active:border-b-0">
                æ¸…é™¤æŠ¼æ³¨
            </button>
            <button id="start-btn" onclick="startGame()" class="flex-[2] py-4 btn-primary rounded-lg text-white text-2xl font-bold">
                å•Ÿå‹• START
            </button>
        </div>
    </div>

    <p class="text-gray-500 text-xs mt-4 text-center">
        æç¤ºï¼šé»æ“Šåœ–æ¡ˆé€²è¡ŒæŠ¼æ³¨ï¼ŒæŠ¼æ»¿å¾ŒæŒ‰ä¸‹å•Ÿå‹•ï¼<br>
        æœ¬éŠæˆ²åƒ…ä¾›å¨›æ¨‚ï¼Œç„¡çœŸå¯¦é‡‘éŒ¢äº¤æ˜“ã€‚
    </p>

    <script>
        // éŠæˆ²è¨­å®š
        const items = [
            { id: 0, type: 'BAR', sym: 'ğŸ†', multi: 100 },
            { id: 1, type: 'CHERRY', sym: 'ğŸ’', multi: 5 },
            { id: 2, type: 'ORANGE', sym: 'ğŸŠ', multi: 10 },
            { id: 3, type: 'LEMON', sym: 'ğŸ‹', multi: 15 },
            { id: 4, type: '77', sym: 'ğŸ’', multi: 40 },
            { id: 5, type: 'CHERRY', sym: 'ğŸ’', multi: 5 },
            { id: 6, type: 'ORANGE', sym: 'ğŸŠ', multi: 10 },
            { id: 7, type: 'BELL', sym: 'ğŸ””', multi: 20 },
            { id: 8, type: 'STAR', sym: 'â­', multi: 30 },
            { id: 9, type: 'CHERRY', sym: 'ğŸ’', multi: 5 },
            { id: 10, type: 'MELON', sym: 'ğŸ‰', multi: 20 },
            { id: 11, type: 'BELL', sym: 'ğŸ””', multi: 20 },
            { id: 12, type: 'BAR', sym: 'ğŸ†', multi: 50 },
            { id: 13, type: 'CHERRY', sym: 'ğŸ’', multi: 5 },
            { id: 14, type: 'ORANGE', sym: 'ğŸŠ', multi: 10 },
            { id: 15, type: 'LEMON', sym: 'ğŸ‹', multi: 15 },
            { id: 16, type: '77', sym: 'ğŸ’', multi: 40 },
            { id: 17, type: 'CHERRY', sym: 'ğŸ’', multi: 5 },
            { id: 18, type: 'ORANGE', sym: 'ğŸŠ', multi: 10 },
            { id: 19, type: 'BELL', sym: 'ğŸ””', multi: 20 },
            { id: 20, type: 'STAR', sym: 'â­', multi: 30 },
            { id: 21, type: 'CHERRY', sym: 'ğŸ’', multi: 5 },
            { id: 22, type: 'MELON', sym: 'ğŸ‰', multi: 20 },
            { id: 23, type: 'LEMON', sym: 'ğŸ‹', multi: 15 }
        ];

        // æ˜ å°„è·¯å¾‘ (å¤–åœä¸€åœˆ)
        const pathOrder = [
            0, 1, 2, 3, 4, 5, 6,
            13, 20, 27, 34,
            33, 32, 31, 30, 29, 28,
            21, 14, 7
        ];
        // å¯¦éš›ä¸Šæˆ‘å€‘éœ€è¦ 24 æ ¼ï¼Œé€™è£¡æ‰‹å‹•èª¿æ•´ä½ˆå±€
        const gridLayout = [
            0, 1, 2, 3, 4, 5, 6,
            23, -1, -1, -1, -1, -1, 7,
            22, -1, -1, -1, -1, -1, 8,
            21, -1, -1, -1, -1, -1, 9,
            20, 19, 18, 17, 16, 15, 14
        ];

        // ç‹€æ…‹è®Šæ•¸
        let credits = 1000;
        let bets = { BAR: 0, '77': 0, STAR: 0, MELON: 0, BELL: 0, LEMON: 0, ORANGE: 0, CHERRY: 0 };
        let currentIndex = 0;
        let isRunning = false;

        // éŸ³æ•ˆåˆæˆå™¨ (ç°¡å–®çš„ Beep è²)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(freq, duration) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        // åˆå§‹åŒ–æ ¼å­—
        function initGrid() {
            const gridEl = document.getElementById('slot-grid');
            gridEl.innerHTML = '';
            
            gridLayout.forEach((val, index) => {
                if (val === -1) {
                    // ä¸­é–“å€åŸŸ
                    if (index === 8) {
                        const panel = document.createElement('div');
                        panel.className = 'center-panel';
                        panel.style.gridColumn = 'span 5';
                        panel.style.gridRow = 'span 3';
                        panel.innerHTML = `
                            <div class="text-xs text-gray-500 mb-1">GOOD LUCK</div>
                            <div id="main-screen" class="display-screen">READY</div>
                            <div class="text-[10px] text-gray-600">ARCADE MACHINE</div>
                        `;
                        gridEl.appendChild(panel);
                    }
                } else {
                    const item = items[val];
                    const div = document.createElement('div');
                    div.id = `slot-${val}`;
                    div.className = 'slot-item';
                    div.innerHTML = `
                        <span class="symbol">${item.sym}</span>
                        <span class="multiplier">x${item.multi}</span>
                    `;
                    gridEl.appendChild(div);
                }
            });
            updateActiveSlot();
        }

        function updateActiveSlot() {
            document.querySelectorAll('.slot-item').forEach(el => el.classList.remove('active', 'win-blink'));
            const active = document.getElementById(`slot-${currentIndex}`);
            if (active) active.classList.add('active');
        }

        function placeBet(type) {
            if (isRunning) return;
            if (credits > 0) {
                bets[type] += 10;
                credits -= 10;
                updateUI();
                playSound(440, 0.05);
            }
        }

        function clearBets() {
            if (isRunning) return;
            for (let key in bets) {
                credits += bets[key];
                bets[key] = 0;
            }
            updateUI();
        }

        function updateUI() {
            document.getElementById('total-credits').innerText = credits;
            for (let key in bets) {
                const el = document.getElementById(`bet-${key}`);
                el.innerText = bets[key];
                el.parentElement.classList.toggle('has-bet', bets[key] > 0);
            }
        }

        function startGame() {
            if (isRunning) return;
            
            const totalBet = Object.values(bets).reduce((a, b) => a + b, 0);
            if (totalBet === 0) {
                document.getElementById('main-screen').innerText = 'NO BET';
                setTimeout(() => document.getElementById('main-screen').innerText = 'READY', 1000);
                return;
            }

            isRunning = true;
            document.getElementById('start-btn').disabled = true;
            document.getElementById('win-display').innerText = '0';
            document.getElementById('win-display').classList.remove('win-blink');
            
            // æ±ºå®šçµ‚é» (éš¨æ©Ÿæ¬Šé‡ç¨å¾Œå¯åŠ ï¼Œç¾åœ¨å…ˆç´”éš¨æ©Ÿ)
            const steps = 50 + Math.floor(Math.random() * 50);
            let currentStep = 0;
            let speed = 50;

            function spin() {
                currentIndex = (currentIndex + 1) % 24;
                updateActiveSlot();
                playSound(880, 0.02);

                currentStep++;
                
                if (currentStep < steps) {
                    // æ§åˆ¶é€Ÿåº¦ï¼šåŠ é€Ÿã€ç­‰é€Ÿã€æ¸›é€Ÿ
                    if (currentStep > steps - 15) {
                        speed += 30; // æ¸›é€Ÿ
                    } else if (speed > 50) {
                        speed -= 5; // åŠ é€Ÿ
                    }
                    setTimeout(spin, speed);
                } else {
                    finishGame();
                }
            }
            spin();
        }

        function finishGame() {
            isRunning = false;
            document.getElementById('start-btn').disabled = false;
            
            const winningItem = items[currentIndex];
            const winAmount = bets[winningItem.type] * winningItem.multi;
            
            if (winAmount > 0) {
                credits += winAmount;
                document.getElementById('win-display').innerText = winAmount;
                document.getElementById('win-display').classList.add('win-blink');
                document.getElementById(`slot-${currentIndex}`).classList.add('win-blink');
                document.getElementById('main-screen').innerText = 'WINNER!';
                
                // å¤§çéŸ³æ•ˆ
                let i = 0;
                const winInterval = setInterval(() => {
                    playSound(1000 + (i % 5) * 200, 0.1);
                    i++;
                    if (i > 10) clearInterval(winInterval);
                }, 100);
            } else {
                document.getElementById('main-screen').innerText = 'TRY AGAIN';
                playSound(200, 0.3);
            }
            
            updateUI();
        }

        // åˆå§‹åŒ–
        window.onload = () => {
            initGrid();
            updateUI();
        };

    </script>
</body>
</html>